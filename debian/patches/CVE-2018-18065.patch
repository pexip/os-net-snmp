From: Robert Story <rstory@freesnmp.com>
Date: Thu, 6 Oct 2016 10:43:10 -0400
Subject: CHANGES: BUG: 2743: snmpd crashes when receiving a GetNext PDU with
 multiple Varbinds
Origin: https://sourceforge.net/p/net-snmp/code/ci/7ffb8e25a0db851953155de91f0170e9bf8c457d/
Bug-Debian-Security: https://security-tracker.debian.org/tracker/CVE-2018-18065
Bug-Debian: https://bugs.debian.org/910638

skip out-of-range varbinds when calling next handler
---
 agent/helpers/table.c | 4 ++++
 1 file changed, 4 insertions(+)

--- a/agent/helpers/table.c
+++ b/agent/helpers/table.c
@@ -406,6 +406,8 @@ table_helper_handler(netsnmp_mib_handler
             if (reqinfo->mode == MODE_GET)
                 table_helper_cleanup(reqinfo, request,
                                      SNMP_NOSUCHOBJECT);
+            else
+                request->processed = 1; /* skip if next handler called */
             continue;
         }
 
@@ -479,10 +481,13 @@
                 if (reqinfo->mode == MODE_SET_RESERVE1)
                     table_helper_cleanup(reqinfo, request,
                                          SNMP_ERR_NOTWRITABLE);
-                else if (reqinfo->mode == MODE_GET)
+                else
 #endif /* NETSNMP_NO_WRITE_SUPPORT */
+                if (reqinfo->mode == MODE_GET)
                     table_helper_cleanup(reqinfo, request,
                                          SNMP_NOSUCHOBJECT);
+                else
+                    request->processed = 1; /* skip if next handler called */
                 continue;
             }
             /*
